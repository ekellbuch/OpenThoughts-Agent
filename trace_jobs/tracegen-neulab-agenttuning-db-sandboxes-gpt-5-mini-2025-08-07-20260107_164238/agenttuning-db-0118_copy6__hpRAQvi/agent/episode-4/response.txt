{
  "analysis": "MariaDB server package was installed but the system's init scripts were prevented from starting the server (policy-rc.d). There is currently no mysqld process and no socket (/run/mysqld). To run SQL locally we must start a mysqld process ourselves. That requires initializing the MariaDB data directory (if it isn't already initialized), creating the runtime directory (/var/run/mysqld), and launching mysqld in the foreground/background. Once mysqld is running and the socket exists we can connect with the mysql client as root and run queries.",
  "plan": "1) Locate the mysqld binary and any available DB initialization script (mariadb-install-db or mysql_install_db). 2) Inspect /var/lib/mysql to see whether it's already initialized. 3) If needed, initialize the data directory. 4) Create /var/run/mysqld and set ownership to mysql:mysql. 5) Start mysqld directly (with --skip-networking to avoid listening on TCP) and wait briefly. 6) Verify the mysqld process and socket, then run a test query: SHOW DATABASES;. If any step fails, inspect logs (/var/log/mysql or journal) to diagnose.",
  "commands": [
    {
      "keystrokes": "which mysqld\n",
      "duration": 0.1
    },
    {
      "keystrokes": "ls -la /var/lib/mysql\n",
      "duration": 0.1
    },
    {
      "keystrokes": "command -v mariadb-install-db || true\n",
      "duration": 0.1
    },
    {
      "keystrokes": "command -v mysql_install_db || true\n",
      "duration": 0.1
    },
    {
      "keystrokes": "if command -v mariadb-install-db >/dev/null 2>&1; then mariadb-install-db --user=mysql --datadir=/var/lib/mysql; elif command -v mysql_install_db >/dev/null 2>&1; then mysql_install_db --user=mysql --datadir=/var/lib/mysql; else echo \"No DB initialization tool found\"; fi\n",
      "duration": 12.0
    },
    {
      "keystrokes": "mkdir -p /var/run/mysqld && chown mysql:mysql /var/run/mysqld\n",
      "duration": 0.5
    },
    {
      "keystrokes": "nohup mysqld --user=mysql --datadir=/var/lib/mysql --socket=/var/run/mysqld/mysqld.sock --pid-file=/var/run/mysqld/mysqld.pid --skip-networking > /var/log/mysql-mysqld.log 2>&1 &\n",
      "duration": 4.0
    },
    {
      "keystrokes": "sleep 2\n",
      "duration": 2.0
    },
    {
      "keystrokes": "ps aux | grep -i mysqld | grep -v grep\n",
      "duration": 0.2
    },
    {
      "keystrokes": "ls -la /var/run/mysqld\n",
      "duration": 0.1
    },
    {
      "keystrokes": "mysql -u root -e \"SHOW DATABASES;\"\n",
      "duration": 1.0
    }
  ],
  "task_complete": false
}